<div class="checkout-container">
  <!-- Left Section -->
  <div class="left-section">
    <form [formGroup]="checkoutForm" (ngSubmit)="placeOrder()" class="billing-form">
      <div class="card">
        <h2 class="section-title">Account Details</h2>
        <div class="card-row">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Full Name</mat-label>
            <input matInput placeholder="John Doe" formControlName="fullName" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Email</mat-label>
            <input matInput placeholder="example@email.com" formControlName="email" />
          </mat-form-field>
        </div>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Phone Number</mat-label>
          <input matInput placeholder="+1 234 567 890" formControlName="phone" />
        </mat-form-field>
        <mat-checkbox class="example-margin" formControlName="create_account"
          >Create an account</mat-checkbox
        >
      </div>
      <div class="card">
        <h2 class="section-title">Shipping Details</h2>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Address</mat-label>
          <input matInput placeholder="Street, City, Country" formControlName="shipping_address" />
        </mat-form-field>
        <div class="card-row">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Country</mat-label>
            <input matInput formControlName="shipping_country" />
          </mat-form-field>
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>State</mat-label>
            <input matInput formControlName="shipping_state" />
          </mat-form-field>
        </div>
        <div class="card-row">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>City</mat-label>
            <input matInput formControlName="shipping_city" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Postal Code</mat-label>
            <input matInput placeholder="ZIP / Postal code" formControlName="shipping_postalCode" />
          </mat-form-field>
        </div>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Phone Number</mat-label>
          <input matInput placeholder="+1 234 567 890" formControlName="shipping_phone" />
        </mat-form-field>
      </div>
      <div class="card">
        <h2 class="section-title">Billing Details</h2>
        <mat-checkbox class="example-margin" formControlName="same_as_billing"
          >Same as Billing Address</mat-checkbox
        >
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Address</mat-label>
          <input matInput placeholder="Street, City, Country" formControlName="billing_address" />
        </mat-form-field>
        <div class="card-row">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Country</mat-label>
            <input matInput formControlName="billing_country" />
          </mat-form-field>
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>State</mat-label>
            <input matInput formControlName="billing_state" />
          </mat-form-field>
        </div>
        <div class="card-row">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>City</mat-label>
            <input matInput formControlName="billing_city" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Postal Code</mat-label>
            <input matInput placeholder="ZIP / Postal code" formControlName="billing_postalCode" />
          </mat-form-field>
        </div>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Phone Number</mat-label>
          <input matInput placeholder="+1 234 567 890" formControlName="billing_phone" />
        </mat-form-field>
      </div>
      <div class="card">
        <h2 class="section-title">Delivery Options</h2>
        <mat-radio-group
          aria-label="Select an option"
          formControlName="deliveryOption"
          class="payment_radio"
        >
          <mat-radio-button value="rush">Rush Order | Approx 3 to 5 business days</mat-radio-button>
          <mat-radio-button value="standard"
            >Standard Order | Approx 8 to 12 business days</mat-radio-button
          >
          <mat-radio-button value="flexible"
            >Flexible Order | Approx 12 to 15 business days</mat-radio-button
          >
        </mat-radio-group>
      </div>

      <div class="card">
        <h3 class="section-subtitle">Payment Method</h3>
        <mat-radio-group formControlName="paymentMethod">
          <mat-radio-button value="card">Credit / Debit Card</mat-radio-button>
          <mat-radio-button value="cod" class="ml-2">Cash on Delivery</mat-radio-button>
        </mat-radio-group>
      </div>
      <button matButton="filled" class="primary-btn" type="submit">Place Order</button>
    </form>
  </div>

  <!-- Right Section -->
  <div class="right-section">
    <div class="order-summary-card">
      <h2 class="section-title summary-title">Order Summary</h2>
      @for (item of cartItems; track $index) {
      <div class="order-item">
        <img [src]="r2BaseUrl + item?.variants?.thumbnail_url" [alt]="item.name" />
        <div class="info">
          <p class="name">{{ item.product_name }}</p>
          <p class="desc">€ {{ (item?.final_price ?? 10) + ' x ' + item.quantity }}</p>
        </div>
        <p class="price">€ {{ (item?.final_price ?? 10) * item.quantity }}</p>
      </div>
      }
      <div class="summary">
        <div class="summary-row">
          <span>Subtotal</span>
          <span>€ {{ totalCost ? totalCost.toFixed(2) : 10 }}</span>
        </div>
        <div class="summary-row">
          <span
            >Shipping {{ this.checkoutForm.value.deliveryOption === 'rush' ? '(10%)' : '' }}</span
          >
          <span>€ {{ shippingAmount ? shippingAmount.toFixed(2) : 0 }}</span>
        </div>
        <div class="summary-row">
          <span>GST (5%)</span>
          <span>€ {{ gstAmount ? gstAmount.toFixed(2) : 10 }}</span>
        </div>
        <div class="summary-row total">
          <span>Total</span>
          <span>${{ grandTotal + 5 }}</span>
        </div>
      </div>

      <div class="summary-footer">
        <p>All prices include taxes.</p>
        <p>
          Your order will be delivered within @if(checkoutForm.value.deliveryOption === 'rush'){ 3
          to 5 business days. }
          <!--  -->
          @else if(checkoutForm.value.deliveryOption === 'standard'){ 8 to 12 business days. }
          <!--  -->
          @else if(checkoutForm.value.deliveryOption === 'flexible'){ 12 to 15 business days. }
        </p>
      </div>
    </div>
  </div>
</div>
